import{i as ce,d as C,m as O,t as Y,n as z,c as q,r as _,g as ue,a as G,b as A,e as de,w as I,f as fe,o as he,h as K,j as U,k as u,l as ve,p as ge,q as J,I as ee,s as W,u as M,v as te,x as me,y as _e,z as ae,A as Q,B as xe,L as ne,C as oe,D as ye,E as be,F as Te,G as X,H as j,J as S,K as H,M as we,O as Se,N as P,_ as se,P as ke,Q as pe,R as Le,S as Pe,T as Z,U as $e,V,W as Ee}from"./index-B9LBo1sz.js";const De=Symbol(),Be=()=>ce(De,null),[ze,$]=q("image"),He={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:z,height:z,radius:z,lazyLoad:Boolean,iconSize:z,showError:Y,errorIcon:O("photo-fail"),iconPrefix:String,showLoading:Y,loadingIcon:O("photo"),crossorigin:String,referrerpolicy:String};var Ie=C({name:ze,props:He,emits:["load","error"],setup(e,{emit:h,slots:o}){const a=_(!1),r=_(!0),l=_(),{$Lazyload:c}=ue().proxy,s=G(()=>{const n={width:A(e.width),height:A(e.height)};return de(e.radius)&&(n.overflow="hidden",n.borderRadius=A(e.radius)),n});I(()=>e.src,()=>{a.value=!1,r.value=!0});const d=n=>{r.value&&(r.value=!1,h("load",n))},g=()=>{const n=new Event("load");Object.defineProperty(n,"target",{value:l.value,enumerable:!0}),d(n)},m=n=>{a.value=!0,r.value=!1,h("error",n)},w=(n,x,k)=>k?k():u(ee,{name:n,size:e.iconSize,class:x,classPrefix:e.iconPrefix},null),y=()=>{if(r.value&&e.showLoading)return u("div",{class:$("loading")},[w(e.loadingIcon,$("loading-icon"),o.loading)]);if(a.value&&e.showError)return u("div",{class:$("error")},[w(e.errorIcon,$("error-icon"),o.error)])},p=()=>{if(a.value||!e.src)return;const n={alt:e.alt,class:$("img"),style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?ve(u("img",J({ref:l},n),null),[[ge("lazy"),e.src]]):u("img",J({ref:l,src:e.src,onLoad:d,onError:m},n),null)},f=({el:n})=>{const x=()=>{n===l.value&&r.value&&g()};l.value?x():U(x)},b=({el:n})=>{n===l.value&&!a.value&&m()};return c&&fe&&(c.$on("loaded",f),c.$on("error",b),he(()=>{c.$off("loaded",f),c.$off("error",b)})),K(()=>{U(()=>{var n;(n=l.value)!=null&&n.complete&&!e.lazyLoad&&g()})}),()=>{var n;return u("div",{class:$({round:e.round,block:e.block}),style:s.value},[p(),y(),(n=o.default)==null?void 0:n.call(o)])}}});const le=W(Ie),[Ce,E,Re]=q("list"),Ve={error:Boolean,offset:M(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:O("down"),loadingText:String,finishedText:String,immediateCheck:Y};var Me=C({name:Ce,props:Ve,emits:["load","update:error","update:loading"],setup(e,{emit:h,slots:o}){const a=_(e.loading),r=_(),l=_(),c=Be(),s=te(r),d=G(()=>e.scroller||s.value),g=()=>{U(()=>{if(a.value||e.finished||e.disabled||e.error||(c==null?void 0:c.value)===!1)return;const{direction:f}=e,b=+e.offset,n=Q(d);if(!n.height||xe(r))return;let x=!1;const k=Q(l);f==="up"?x=n.top-k.top<=b:x=k.bottom-n.bottom<=b,x&&(a.value=!0,h("update:loading",!0),h("load"))})},m=()=>{if(e.finished){const f=o.finished?o.finished():e.finishedText;if(f)return u("div",{class:E("finished-text")},[f])}},w=()=>{h("update:error",!1),g()},y=()=>{if(e.error){const f=o.error?o.error():e.errorText;if(f)return u("div",{role:"button",class:E("error-text"),tabindex:0,onClick:w},[f])}},p=()=>{if(a.value&&!e.finished&&!e.disabled)return u("div",{class:E("loading")},[o.loading?o.loading():u(ne,{class:E("loading-icon")},{default:()=>[e.loadingText||Re("loading")]})])};return I(()=>[e.loading,e.finished,e.error],g),c&&I(c,f=>{f&&g()}),me(()=>{a.value=e.loading}),K(()=>{e.immediateCheck&&g()}),_e({check:g}),ae("scroll",g,{target:d,passive:!0}),()=>{var f;const b=(f=o.default)==null?void 0:f.call(o),n=u("div",{ref:l,class:E("placeholder")},null);return u("div",{ref:r,role:"feed",class:E(),"aria-busy":a.value},[e.direction==="down"?b:n,p(),m(),y(),e.direction==="up"?b:n])}}});const je=W(Me),[Ue,B,Ae]=q("pull-refresh"),re=50,Fe=["pulling","loosing","success"],Ne={disabled:Boolean,modelValue:Boolean,headHeight:M(re),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:z,successDuration:M(500),animationDuration:M(300)};var Oe=C({name:Ue,props:Ne,emits:["change","refresh","update:modelValue"],setup(e,{emit:h,slots:o}){let a;const r=_(),l=_(),c=te(r),s=oe({status:"normal",distance:0,duration:0}),d=ye(),g=()=>{if(e.headHeight!==re)return{height:`${e.headHeight}px`}},m=()=>s.status!=="loading"&&s.status!=="success"&&!e.disabled,w=t=>{const i=+(e.pullDistance||e.headHeight);return t>i&&(t<i*2?t=i+(t-i)/2:t=i*1.5+(t-i*2)/4),Math.round(t)},y=(t,i)=>{const T=+(e.pullDistance||e.headHeight);s.distance=t,i?s.status="loading":t===0?s.status="normal":t<T?s.status="pulling":s.status="loosing",h("change",{status:s.status,distance:t})},p=()=>{const{status:t}=s;return t==="normal"?"":e[`${t}Text`]||Ae(t)},f=()=>{const{status:t,distance:i}=s;if(o[t])return o[t]({distance:i});const T=[];return Fe.includes(t)&&T.push(u("div",{class:B("text")},[p()])),t==="loading"&&T.push(u(ne,{class:B("loading")},{default:p})),T},b=()=>{s.status="success",setTimeout(()=>{y(0)},+e.successDuration)},n=t=>{a=be(c.value)===0,a&&(s.duration=0,d.start(t))},x=t=>{m()&&n(t)},k=t=>{if(m()){a||n(t);const{deltaY:i}=d;d.move(t),a&&i.value>=0&&d.isVertical()&&(Te(t),y(w(i.value)))}},L=()=>{a&&d.deltaY.value&&m()&&(s.duration=+e.animationDuration,s.status==="loosing"?(y(+e.headHeight,!0),h("update:modelValue",!0),U(()=>h("refresh"))):y(0))};return I(()=>e.modelValue,t=>{s.duration=+e.animationDuration,t?y(+e.headHeight,!0):o.success||e.successText?b():y(0,!1)}),ae("touchmove",k,{target:l}),()=>{var t;const i={transitionDuration:`${s.duration}ms`,transform:s.distance?`translate3d(0,${s.distance}px, 0)`:""};return u("div",{ref:r,class:B()},[u("div",{ref:l,class:B("track"),style:i,onTouchstartPassive:x,onTouchend:L,onTouchcancel:L},[u("div",{class:B("head"),style:g()},[f()]),(t=o.default)==null?void 0:t.call(o)])])}}});const Ye=W(Oe),qe=["src"],Ge=C({__name:"Overlay",setup(e,{expose:h}){const o=_(!1),a=_({type:0,src:""});return I(o,l=>{l||(a.value={type:0,src:""})}),h({handleShow:(l,c)=>{o.value=!o.value,a.value.type=l,a.value.src=c}}),(l,c)=>{const s=le,d=Se;return P(),X(d,{teleport:"#app",show:o.value,duration:0,onClick:c[1]||(c[1]=g=>o.value=!1)},{default:j(()=>[S("div",{class:"px-4 w-full fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",onClick:c[0]||(c[0]=we(()=>{},["stop"]))},[a.value.type===0?(P(),X(s,{key:0,class:"w-full rounded-md",src:a.value.src,fit:"contain"},null,8,["src"])):(P(),H("video",{key:1,class:"w-full rounded-md",src:a.value.src,autoplay:"",controls:""},null,8,qe))])]),_:1},8,["show"])}}}),Ke=se(Ge,[["__scopeId","data-v-c063b79b"]]);function F(e,h){return Math.floor(Math.random()*(h-e+1))+e}const We=[200,230,250,300,280,200,230,250,300,280];function N(e=0,h="1"){let o=[];for(let a=0;a<10;a++){const r=e+a,l=F(0,9),c=We[l],s=F(0,1);let d="",g="",m="";h==="1"?(d="【新英雄预告】法术机关枪！符文法师瑞兹上线体验服~Faker×瑞兹联动表情包来了！"+r,g="英雄联盟"+r,m="用户昭昭"+r):(d="【新工具上线】蛋仔排队盲盒模拟器登场啦，快来体验领取吧"+r,g="蛋仔派对"+r,m="用户热带椰"+r);const w="https://picsum.photos/200/150?"+r+h;o.push({height:c,background:`hsl(${l*10}, 100%, 50%)`,type:s,src:s===0?w:["http://vjs.zencdn.net/v/oceans.mp4","https://media.w3.org/2010/05/sintel/trailer.mp4"][a%2],poster:w,title:d,about:g,username:m,zan:F(0,e+a)})}return o}const Je={class:"home bg-white py-2"},Qe=["onClick"],Xe={class:"flex-1 relative overflow-hidden"},Ze={key:0,class:"w-full h-full cursor-pointer bg-[rgba(0,0,0,0.3)] absolute top-0 left-0 bg-[url('@/assets/play.png')] bg-no-repeat bg-[length:4rem_4rem] bg-[center_center]"},et={class:"px-1 py-1 font-normal"},tt={class:"ellipsis-2 text-sm font-bold"},at={class:"text-sm my-[4] text-[12px]"},nt={class:"flex justify-between items-center text-[12px]"},ot={class:"flex items-center"},st=C({__name:"Community",setup(e){const h=pe(),{symbol:o}=ke(h.query),a=_([]),r=oe([]),l=_([]);let c=6;const s=document.body.clientWidth,d=s/2-5,g=Math.floor(s/d),m=L=>{l.value=[];for(let t=0;t<L.length;t++){let i=L[t];if(t<g)r.push({...i,left:t*d,top:0}),l.value.push(i.height);else{let T=l.value[0],D=0;l.value.forEach((R,v)=>{T>R&&(T=R,D=v)}),r.push({...i,left:D*d,top:T+c}),l.value[D]=T+i.height+c}}},w=G(()=>l.value.length?Math.max.apply(Math,l.value):0),y=_(),p=(L,t)=>{var i;(i=y.value)==null||i.handleShow(L,t)},f=_(!1),b=()=>{setTimeout(()=>{Ee("刷新成功"),f.value=!1,a.value=[],r.length=0,a.value=[...N(a.value.length,o.value)],m(a.value)},1500)},n=_(!1),x=_(!1),k=()=>{console.log("onLoad"),setTimeout(()=>{a.value=[...a.value,...N(a.value.length,o.value)],m(a.value),a.value.length>=40&&(x.value=!0),n.value=!1},1500)};return K(()=>{a.value=[...a.value,...N(a.value.length,o.value)],m(a.value),a.value.length>=50&&(x.value=!0)}),(L,t)=>{const i=le,T=ee,D=je,R=Ye;return P(),H("div",Je,[u(Ke,{ref_key:"overlayRef",ref:y},null,512),u(R,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=v=>f.value=v),onRefresh:b},{success:j(()=>t[2]||(t[2]=[])),default:j(()=>[u(D,{loading:n.value,"onUpdate:loading":t[0]||(t[0]=v=>n.value=v),finished:x.value,"finished-text":"没有更多了",onLoad:k},{default:j(()=>[S("div",{class:"wrap p-1 h-full",style:Z({height:w.value+"px"})},[(P(!0),H(Le,null,Pe(r,(v,ie)=>(P(),H("div",{key:ie,class:"items rounded-md flex flex-col bg-white",style:Z({height:v.height+"px",left:v.left+"px",top:v.top+"px"}),onClick:lt=>p(v.type,v.src)},[S("div",Xe,[u(i,{class:"w-full h-full",fit:"cover","lazy-load":"",src:v.type===0?v.src:v.poster},null,8,["src"]),v.type===1?(P(),H("div",Ze)):$e("",!0)]),S("div",et,[S("div",tt,V(v.title),1),S("div",at,V(v.about),1),S("div",nt,[S("div",null,V(v.username),1),S("div",ot,[u(T,{name:"good-job-o",class:"mt-[2px] mr-1"}),S("span",null,V(v.zan),1)])])])],12,Qe))),128))],4)]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])])}}}),it=se(st,[["__scopeId","data-v-663768a1"]]);export{it as default};
